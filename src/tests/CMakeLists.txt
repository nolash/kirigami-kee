add_library(testutils testutil.c)
set_property(TARGET testutils PROPERTY C_VISIBILITY_PRESET visible)
set_property(TARGET testutils PROPERTY VISIBILITY_INLINES_HIDDEN OFF)
add_executable(test_gpg test_gpg.cpp ../gpg.cpp ../term_debug.c)
add_executable(test_gpg_nokey test_gpg_nokey.cpp ../gpg.cpp ../term_debug.c)
add_executable(test_gpg_sym test_gpg_sym.cpp ../gpg.cpp ../term_debug.c)
target_link_libraries(test_gpg gcrypt utils)
target_link_libraries(test_gpg_nokey gcrypt utils)
target_link_libraries(test_gpg_sym gcrypt utils testutils)
target_include_directories(test_gpg PRIVATE ..)
target_include_directories(test_gpg_nokey PRIVATE ..)
target_include_directories(test_gpg_sym PRIVATE .. .)
add_test(NAME gpg COMMAND test_gpg)
add_test(NAME gpg_nokey COMMAND test_gpg_nokey)
add_test(NAME gpg_sym COMMAND test_gpg_sym)
configure_file(key.bin ${CMAKE_CURRENT_BINARY_DIR}/key.bin COPYONLY)
